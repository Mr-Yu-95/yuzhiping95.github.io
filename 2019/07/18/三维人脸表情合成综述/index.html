<!DOCTYPE html>












  


<html class="theme-next gemini use-motion" lang="zh-CN">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
























<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2">

<link rel="stylesheet" href="/css/main.css?v=7.1.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.1.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=7.1.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=7.1.0">


  <link rel="mask-icon" href="/images/logo.svg?v=7.1.0" color="#222">







<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '7.1.0',
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false,"dimmer":false},
    back2top: true,
    back2top_sidebar: true,
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="三维人脸表情合成综述3D Facial Expression Synthesis: A Survey 摘要 ​    人脸表情合成是计算机视觉和图形学领域的一个研究热点，面部表情合成是利用初始面部生成新面部形状并能够保持初始面部特征的过程。面部表情的丰富性和人脸表面的复杂性，使得表情因人而异且千变万化。人脸表情的变化不仅包括整体面部特征的运动变形，而且包括局部纹理的细微变化，而这些局部的表情细节往">
<meta name="keywords" content="译文">
<meta property="og:type" content="article">
<meta property="og:title" content="三维人脸表情合成综述">
<meta property="og:url" content="http://yoursite.com/2019/07/18/三维人脸表情合成综述/index.html">
<meta property="og:site_name" content="遇见西门">
<meta property="og:description" content="三维人脸表情合成综述3D Facial Expression Synthesis: A Survey 摘要 ​    人脸表情合成是计算机视觉和图形学领域的一个研究热点，面部表情合成是利用初始面部生成新面部形状并能够保持初始面部特征的过程。面部表情的丰富性和人脸表面的复杂性，使得表情因人而异且千变万化。人脸表情的变化不仅包括整体面部特征的运动变形，而且包括局部纹理的细微变化，而这些局部的表情细节往">
<meta property="og:locale" content="zh-CN">
<meta property="og:updated_time" content="2019-07-18T02:36:42.597Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="三维人脸表情合成综述">
<meta name="twitter:description" content="三维人脸表情合成综述3D Facial Expression Synthesis: A Survey 摘要 ​    人脸表情合成是计算机视觉和图形学领域的一个研究热点，面部表情合成是利用初始面部生成新面部形状并能够保持初始面部特征的过程。面部表情的丰富性和人脸表面的复杂性，使得表情因人而异且千变万化。人脸表情的变化不仅包括整体面部特征的运动变形，而且包括局部纹理的细微变化，而这些局部的表情细节往">





  
  
  <link rel="canonical" href="http://yoursite.com/2019/07/18/三维人脸表情合成综述/">



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>三维人脸表情合成综述 | 遇见西门</title>
  












  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">遇见西门</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">

    
    
    
      
    

    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>首页</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-about">

    
    
    
      
    

    

    <a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i> <br>关于</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">

    
    
    
      
    

    

    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br>标签</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">

    
    
    
      
    

    

    <a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br>分类</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>归档</a>

  </li>

      
      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>搜索</a>
        </li>
      
    </ul>
  

  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



  



</div>
    </header>

    
  
  

  

  <a href="https://github.com/yuzhiping95" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewbox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"/><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"/><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"/></svg></a>



    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
            

          
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/07/18/三维人脸表情合成综述/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Yu ZhiPing">
      <meta itemprop="description" content="致力于用代码改变这个世界！">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="遇见西门">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">三维人脸表情合成综述

              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-07-18 10:30:23 / 修改时间：10:36:42" itemprop="dateCreated datePublished" datetime="2019-07-18T10:30:23+08:00">2019-07-18</time>
            

            
              

              
            
          </span>

          

          
            
            
          

          
          
            <span id="/2019/07/18/三维人脸表情合成综述/" class="leancloud_visitors" data-flag-title="三维人脸表情合成综述">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              
                <span class="post-meta-item-text">阅读次数：</span>
              
                <span class="leancloud-visitors-count"></span>
            </span>
          

          

          
            <div class="post-symbolscount">
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">本文字数：</span>
                
                <span title="本文字数">8.3k</span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">8 分钟</span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="三维人脸表情合成综述"><a href="#三维人脸表情合成综述" class="headerlink" title="三维人脸表情合成综述"></a>三维人脸表情合成综述</h1><h3 id="3D-Facial-Expression-Synthesis-A-Survey"><a href="#3D-Facial-Expression-Synthesis-A-Survey" class="headerlink" title="3D Facial Expression Synthesis: A Survey"></a>3D Facial Expression Synthesis: A Survey</h3><h5 id><a href="#" class="headerlink" title=" "></a> </h5><p>摘要</p>
<p>​    人脸表情合成是计算机视觉和图形学领域的一个研究热点，面部表情合成是利用初始面部生成新面部形状并能够保持初始面部特征的过程。面部表情的丰富性和人脸表面的复杂性，使得表情因人而异且千变万化。人脸表情的变化不仅包括整体面部特征的运动变形，而且包括局部纹理的细微变化，而这些局部的表情细节往往是判定表情类别的重要视觉线索，但是它们合成起来却非常困难。</p>
<p>​    早期面部合成工作使用2D面部图像。现如今，由于3D扫描仪技术的成熟，面部合成工作逐步转向使用3D面部数据。3D面部能够保持更多的几何形状数据并且对于姿势和照明是不变的，具有2D面部图像不可比拟的良好特性。本文列举了3D面部表情合成的方法，概述了3D面部表情合成的应用和优点，回顾了一些最新的3D面部表情合成方法。</p>
<p>关键词：人脸表情 三维人脸 合成 </p>
<p>ABSTRACT</p>
<p>Facial expression synthesis is a hot research topic in the  fields of computer vision and graphics. Facial expression synthesis is a process of generating new face shapes from a given face and still retain the distinct facial characteristics of the initial face. Because of the richness of facial expressions and the complexity of facial appearance, facial expressions of different people vary greatly. The variation of facial expression not only includes the motion of global facial features, but also includes the subtle deformations of local texture. These local expression details are important  visual cues for the judgment of the expression categories. However, the synthesis of the expression details is rather difficult.</p>
<p>Earlier work on synthesizing face shapes used 2D face images. Nowadays, the facial expression synthesis work moved to using 3D face shapes given the  improvement in 3D scanner technologies. 3D face holds more geometric shape data and is invariant to poses and illumination. Compared with 2d facial images, 3D facial data has incomparable good characteristic. This paper enumerates the methods of 3D facial expression synthesis, outlines the applications and advantages of 3D facial expression synthesis, and reviews some of the latest 3D facial expression synthesis methods.</p>
<p>Keywords: Facial expression  3D faces  synthesis</p>
<h5 id="一、-说明"><a href="#一、-说明" class="headerlink" title="一、  说明"></a>一、  说明</h5><p>面部表情合成是计算机视觉和生物识别技术中日益兴盛的研究领域。它具有多方面的优点，尤其是在面部识别和面部重建方面。面部表情可以描述为面部肌肉的运动或位置的改变，从而引起个体情绪状态的改变。</p>
<p>人们通过某种特殊的能力来理解其他人的面部表情。随着人们对计算机依赖日益加重，如果计算机可以识别人类的面部表情以增强人机交互的能力，那将是非常有意义的。</p>
<p>这导致了计算机视觉领域出现了一些研究热点，其中之一便是合成面部表情。面部表情合成意味着在二维图像或3D面部数据上人工创建或复制人类面部表情，在本文中，我们将讨论合成逼真面部表情的几种方法，尤其是在3D面部上。</p>
<p>当面部表情合成技术应用于某些系统时，我们发现系统的性能得到了极大程度的提升。例如，它可以改善人脸识别系统，人脸识别是通过将面部与已知面部库相匹配来识别面部的一个过程[8][4][7]，然而轻微的表情变化会极大地降低识别的准确性。Chang等人[7]的实验表明，没有任何表情的面部识别率能达到90％，但当添加面部表情时，识别率骤降到25％至50％之间。当在面部识别环境中实现时，可以使用合成中性面部表情来解决该问题。</p>
<p>面部表情合成作为性别分类算法的一部分也是十分有益的。现有的性别分类方法仅涉及中性面孔[14][16]，在进行性别分类之前，我们可以通过其他面部表情合成中性面部表情。</p>
<p>动画制作工作室还可以使用面部表情合成技术来减少将表情传递到角色面部上所需的帧数，视频游戏开发者还可以在3D模型和头像上合成逼真的面部表情。</p>
<p>面部表情合成还可以改善人机交互。例如，移动设备上的前置摄像头可用于跟踪面部表情以猜测用户的情绪状态，该信息可以帮助设备执行某些任务，例如，如果它感知到用户处于悲伤的情绪，反馈机制可以启动娱乐模式。面部表情合成还可用于改善移动设备上的访问控制，用户无需保持中性面部表情即可登录。</p>
<h5 id="二、-背景"><a href="#二、-背景" class="headerlink" title="二、  背景"></a>二、  背景</h5><p>为了合成面部表情，我们需要了解面部解剖学以及如何创建面部表情。面部肌肉的收缩松弛与下颌骨的运动相结合，进而产生不同形式的面部表情。</p>
<p>特定的面部肌肉与颅骨，特别是下颌骨，相互配合在人脸上产生各种不同的面部表情，如图1所示。这些肌肉组通过特定的模式变形，将面部各部分表情或外观组成一个整体，如讲话，打哈欠等。</p>
<p>心理学家Paul Ekman和Wallace V. Friesen[1]在1978年研究了人类面部解剖学并创建了面部动作编码系统（FACS）框架，以解释面部肌肉收缩如何改变与表情创建相关的外观。他们使用动作单元（AU）来描述面部肌肉的收缩或放松。所有面部表情都可以由AU表示，并可以通过强度、不对称性和持续时间进一步描述。几乎任何可能的面部表情都可以由FACS手动编码实现。</p>
<p>​    这是通过将其构建成AU的组件以产生面部表情来完成的。Ekman还创建了EMFACS（情绪面部动作编码系统），它只考虑与情绪相关的面部动作。Ekman在FACS方面的工作激发了研究人员使用基于肌肉的面部模型来创建面部表情。</p>
<p>二十多年来，已经有许多方法来实现面部表情合成。面部表情合成方法可以分为两类，几何或三维（3D）操作和图像处理[2]。在本文中，我们将重点介绍用于在3D人脸上合成逼真的面部表情的三维几何操纵方法，例如插值，基于物理的肌肉模型，包括质量弹簧网格肌肉模型，矢量肌肉模型和层弹簧网格肌肉模型[13]。其他是伪肌肉模型，自由形态变形，样条伪肌，基于统计的方法，基于倾斜的方法，变形以及最终的MPEG-4面部动画参数。</p>
<h5 id="三、-方法"><a href="#三、-方法" class="headerlink" title="三、  方法"></a>三、  方法</h5><p>(一)    关键帧插值法</p>
<p>插值函数用于在标准化时间间隔内指定两个关键帧之间的平滑运动，关键帧插值法使三维空间中的一个空间定点从一个位置移动到另一个位置，通过计算得到这两个点之间的轨迹样条，使用一个插值函数指定了两幅关键帧之间的光滑运动，因而中间帧的形态可以通过插值得到。关键帧插值法优点是操作直观、计算速度快，可以快速地创建出面部表情，缺点是在实际的面部配置的范围内受到限制。插值可以与图像变形相结合创建出广泛的面部表情变化。几何插值直接更新面部网格顶点的3D位置，而参数插值控制间接顶点移动的函数。 Sera等人，通过执行弹簧肌肉力参数的线性插值而不是顶点的位置的改变来实现嘴部形状改变。图2显示了混合形状的线性插值</p>
<p>(二)   基于物理的方法</p>
<p>基于物理的肌肉方法可分为质量弹簧法，矢量肌肉法和分层弹簧网状肌肉法。这些方法是在混合形状数据上进行的，混合形状数据是许多拓扑符合形状基元的线性加权和。</p>
<p>质量弹簧网状肌肉法是将肌肉力量分布在模拟皮肤变形的弹性弹簧网中，当力通过肌肉弧施加到弹性网格时，网格发生变化，产生逼真的面部表情。使用质量弹簧进行面部表情合成的早期工作是由Platt和Badler 进行的。他们的研究重点是对人脸结构相关的肌肉进行建模。后来研究员又提出了一种面部模型，其中肌肉表示为面部结构限定区域中虚构块的集合。该模型由38个区域肌肉块组成，这些肌肉块在弹簧网中相互连接。最近，Kahler等人提供了一个将质量弹簧肌肉指定为3D几何体的编辑工具，其使用的三维面部数据是混合形状。</p>
<p>矢量肌肉法是一种基于物理的方法，通过影响区域中的运动场来变形面部网格。它利用描绘的变形场来模拟肌肉对皮肤的作用，将FACS框架应用于Vector Muscle（VM）方法进行面部表情合成。这种方法的缺点是将矢量肌肉准确定位到解剖学位置上是一项艰巨的任务，在无法保证有效或最佳放置条件下，研究员必须进行手动试验，将VM放置到不正确的位置将导致构成面部模型的网格异常或生成不合需要的动画[30]。由于面部网状结构独立性的紧凑表示，矢量肌肉广泛用于混合形状。图3示出了肌肉定义，其包括矢量场方向，原点和插入点。</p>
<p>杨等人提出了一种新的三维人脸物理模型，人脸模型是一个基于解剖学的多层次网格结构，改进的物理弹簧模型模拟人脸皮肤组织，一系列解剖学依据的人脸肌肉元以及下层的骨骼结构，使用的非线性弹簧直接模拟软组织的非线形弹性行为，发展了一个新的边斥力弹簧来防止皮肤模型的崩溃，骨骼层的存在很好的约束了皮肤的运动，有利于人脸肌肉的定位。</p>
<p>另一种基于物理学的方法是分层弹簧网状肌肉方法。该方法模拟了人脸的详细解剖结构和动力学[31]。它由三层可变形网状物组成，对应于面部皮肤，脂肪组织和与骨骼相连的肌肉。该方法可以实现面部表情真实感。缺点是在使用3D网格模拟体积变形时需要大量计算。为了减少计算时间并保持相似的质量，可以采用简化网格系统的方式。图4显示了格子构造后皮肤的拓扑结构。 960个多边形用于模拟组织，大约6500个弹簧单元。图4（b）表示当由于颧肌的影响而抬高唇角时的组织变形。</p>
<p>(三)    伪肌肉模型</p>
<p>伪肌肉模型方法通过近似脸部解剖结构实现逼真的面部表情合成。面部肌肉的大幅度变化通过自由形态变形和样条来模拟。该方法的实例是自由形态变形（FFD）和样条假肌，这些方法是在混合形状数据上进行的。FFD通过操纵3D点阵中的控制点来变形体积对象。不同类型的表面图元可以使用FFD变形，例如多边形网格，二次参数隐式曲面和坚实的模型，变化是EFFD（扩展自由形变），其允许控制点网格延伸成圆柱形结构。</p>
<p>另一种自由形式变化是合理自由变形（RFFD），其中包含每个控制点的权重因子。样条假肌支持均匀灵活的变形，允许在面部表面上进行局部变形，并降低所涉及的计算复杂性。通过使用分层样条模型可以减少不必要的控制点的数量。双立方或B样条提供平滑性和灵活性，这是传统多边形模型难以实现的。当变形需要比补丁分辨率更精细时，使用原生B样条用于复杂曲面的缺点变得更加明显。分层B样条是一种经济且更紧凑的方法，用于表示样条曲面以实现高渲染速度，与分层样条曲面相结合的肌肉能够创建各种面部表情。</p>
<p>(四)    基于统计的方法</p>
<p>基于统计的方法基于面部数据样本的集合来合成表情。这里，我们可以以低计算成本实时合成逼真的面部表情。活动形状模型和统计判别模型是用于合成面部表情的统计方法的示例。</p>
<p>使用活动形状模型（ASM），可以生成新的面部表情，因为表面点沿着训练集空间中最具判别性和表达性的矢量方向移动。由T. Cootes和C. Taylor开发的ASM是一种统计模型的对象形状，它可以迭代地变形以适应新图像中的对象。点分布模型（PDM）用于约束形状，使得它们仅能在标记示例的训练集中看到变化。一组点用于表示对象的形状，其由形状模型控制。 ASM广泛用于2D和3D面部分析和医学图像。</p>
<p>Minoi等人使用统计判别模型（SDM）在3D人脸数据上合成逼真的面部表情。SDM基于两阶段分离超平面来解释和重建面部数据。 SDM需要将捕获的图像预对准到公共模板，以便最小化与面部差异无关的变化。主成分分析（PCA）首先用于降低原始面部数据的维数。其次，最大不确定性线性判别分析（mLDA）用于表征面部数据分组。</p>
<p>另外，我们可以基于最具判别性的变化向量来完成面部数据的重建。Minoi等人将该方法在宾厄姆顿大学3D面部表情数据库（BU3DFE）上进行了测试，结果显示，使用统计判别模型（SDM）在3D人脸数据上能够合成逼真的面部表情。</p>
<p>(五)    基于学习的方法</p>
<p>随着机器学习特别是深度学习的火热，三维表情合成衍生出基于学习的合成方法。考虑到具有面部表情的3D面部模型，Guang等人专注于恢复三维中性面部。他们使用基于学习的方法从样本中去除面部表情残留物，然后使用来自输入表情面部模型的推断表情残基来恢复中性表情。他们在BU-3DFE数据集上进行的实验结果表明他们的方法有显着的效果。他们使用具有11个标记点的通用面部模型来对齐和统一测试样本，以便他们可以专注于在测试面上合成中性面部表情。</p>
<p>构建生成面部模型的方法应呈现以下理想地特征。首先，这些方法应该利用所有可用的训练数据，这些数据禁止在数据中假定特定因子代表性的策略，例如，完整的训练数据张量，捕获身份和表情的所有组合。其次，这些方法应该能处理被噪声破坏的数据，包括几何噪声和因子的错误标签。第三，这些方法应该需要很少或不需要预处理，因此避免了对训练数据准确登记的需要。第四，生成模型应能够编码3D面的丰富形状变化，同时解耦所考虑的不同因素的影响。</p>
<p>Victoria Fernandez Abrevaya等人提出了使用自动编码器架构学习生成3D人脸模型的新框架。主要创新是将基于卷积神经网络（CNN）的编码器与多线性模型解码器相结合。通过利用经典的无监督自动编码器，框架允许弱监督模型学习。它进一步结合了编码器鲁棒性与修复损坏和不完整数据的卷积网络的优点，能够在解码器中有效建模和解耦形状变化的数据属性的多线性模型。该方法继承了自动编码器的优势，可向大型数据集拓展。此外，使用多线性模型作为解码器能够使我们明确地利用显示相同因子的冗余训练数据，并且有效地解耦学习表示中的形状变化。</p>
<p>(六)    变形</p>
<p>Yang等人提出了一种使用图形处理单元（GPU）进行实时面部表情合成的3D目标变形方法。他们使用七步算法;创建变形目标表达式，评估差异向量，初始化变形数据结构，将数据加载到顶点缓冲区对象，将属性链接到着色器并渲染面部表情。他们的方法的一个优点是快速高效的计算，这是由GPU流水线中集成的快速变形过程产生的。它在3D游戏的开发中应用时可实现高帧/秒（FPS），以增强化身的沉浸和逼真外观。</p>
<p>另一项工作，Blanz等人在可变形3D面上生成新的面部表情和属性。从一组示例3D面部模型开始，它们通过将示例的形状和纹理变换为矢量空间表示来导出可变形面部模型。通过添加或减去特定于属性的形状和纹理向量来建模新的面部和表情。应用基于性能的技术[43]，通过记录具有不同表情的相同受试者的两次扫描，并将表情残基差异添加到中性表情中的不同受试者上来合成面部表情。</p>
<p>(七)    MPEG-4面部动画参数（FAPS）</p>
<p>Patel等人借助于从2D面部数据生成的3D人脸模型上的MPEG-4面部动画参数（FAPS）生成六个面部表情。他们还使用BU-3DFE数据集测试和评估了他们的结果。</p>
<p>他们的系统由三个部分组成。第一个是负责识别面部的明显特征，如嘴巴，脸部轮廓，眼睛和眉毛。第二个组件负责通过几何变换自动调整通用3D模型到特定特定的3D模型。最后，在生成的面部模型上执行面部表情合成。图6说明了如何完成特征提取并在面部模型上合成表情。</p>
<p>(八)    讨论</p>
<p>我们已经研究了几种在3D人脸数据上合成面部表情的方法，并且可以看到研究领域中一些有趣的趋势。其中之一是用于评估算法的3D面部数据的类型。一些3D数据是计算机生成的混合形状面。另一些3D数据来自于将真实人脸的2D图像转换为3D面部数据。此外，由于3D图像捕获技术的进步，我们还拥有从人类主体捕获的3D面部。然后对这些面部数据进行预处理并用于不同目的，例如在评估面部识别算法时，人们使用3D捕获设备获得的3D面部数据集，比如英国伦敦帝国学院和宾厄姆顿大学3D面部表情数据集（BU-3DFED）。另一点需要注意的是，不同的3D面部表情合成方法最适合于特定目的。例如，基于统计的方法主要应用于人脸识别，而基于物理的方法应用于计算机动画和游戏。</p>
<p>(九)    总结</p>
<p>由于维度的增加，三维人脸数据包含了更多、更丰富的信息；其次，三维人脸数据克服了二维人脸数据的一些缺陷，例如，光照、化妆、姿态等因素的影响，在本文中，我们研究了不同的合成面部表情的方法，总结如下：物理学，伪肌肉模型，统计学，基于学习，变形和面部动画参数。作为插件，3D面部表情合成可以改善人脸识别系统和性别分类算法的性能。它还用于动画工作室制作和视频游戏，并且可以在应用于移动应用程序时改善人机交互。</p>

      
    </div>

    

    
    
    

    

    
      
    
    
      <div>
        <div id="reward-container">
  <div></div>
  <button id="reward-button" disable="enable" onclick="var qr = document.getElementById(&quot;qr&quot;); qr.style.display = (qr.style.display === 'none') ? 'block' : 'none';">
    打赏
  </button>
  <div id="qr" style="display: none;">

    
      
      
        
      
      <div style="display: inline-block">
        <img src="/images/wechatpay.png" alt="Yu ZhiPing 微信支付">
        <p>微信支付</p>
      </div>
    
      
      
        
      
      <div style="display: inline-block">
        <img src="/images/alipay.png" alt="Yu ZhiPing 支付宝">
        <p>支付宝</p>
      </div>
    

  </div>
</div>

      </div>
    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/译文/" rel="tag"># 译文</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2019/07/09/随手摘录7/" rel="next" title="关于读书">
                <i class="fa fa-chevron-left"></i> 关于读书
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>


  </div>


          </div>
          

  
    <div class="comments" id="comments">
      <div id="lv-container" data-id="city" data-uid="MTAyMC80MzU4Mi8yMDEyMQ=="></div>
    </div>

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/avatar.gif" alt="Yu ZhiPing">
            
              <p class="site-author-name" itemprop="name">Yu ZhiPing</p>
              <div class="site-description motion-element" itemprop="description">致力于用代码改变这个世界！</div>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">14</span>
                    <span class="site-state-item-name">日志</span>
                  </a>
                </div>
              

              

              
                
                
                <div class="site-state-item site-state-tags">
                  
                    
                      <a href="/tags/">
                    
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">6</span>
                    <span class="site-state-item-name">标签</span>
                  </a>
                </div>
              
            </nav>
          

          

          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="https://github.com/yuzhiping95" title="GitHub &rarr; https://github.com/yuzhiping95" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="mailto:1355433160@qq.com" title="E-Mail &rarr; mailto:1355433160@qq.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="https://weibo.com/天线宝宝8" title="Weibo &rarr; https://weibo.com/天线宝宝8" rel="noopener" target="_blank"><i class="fa fa-fw fa-weibo"></i>Weibo</a>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="https://stackoverflow.com" title="StackOverflow &rarr; https://stackoverflow.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-stack-overflow"></i>StackOverflow</a>
                </span>
              
            </div>
          

          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-block">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-link"></i>
                友情链接
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="http://www.cnki.net" title="http://www.cnki.net" rel="noopener" target="_blank">知网</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://ieeexplore.ieee.org/" title="https://ieeexplore.ieee.org/" rel="noopener" target="_blank">IEEE xplore</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://dl.acm.org" title="https://dl.acm.org" rel="noopener" target="_blank">ACM digital library</a>
                  </li>
                
              </ul>
            </div>
          

          
            
          
          

        </div>
      </div>

      
      <!--noindex-->
        <div class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
            
            
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#三维人脸表情合成综述"><span class="nav-number">1.</span> <span class="nav-text">三维人脸表情合成综述</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3D-Facial-Expression-Synthesis-A-Survey"><span class="nav-number">1.0.1.</span> <span class="nav-text">3D Facial Expression Synthesis: A Survey</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#"><span class="nav-number">1.0.1.0.1.</span> <span class="nav-text"> </span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#一、-说明"><span class="nav-number">1.0.1.0.2.</span> <span class="nav-text">一、  说明</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#二、-背景"><span class="nav-number">1.0.1.0.3.</span> <span class="nav-text">二、  背景</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#三、-方法"><span class="nav-number">1.0.1.0.4.</span> <span class="nav-text">三、  方法</span></a></li></ol></li></ol></li></ol></div>
            

          </div>
        </div>
      <!--/noindex-->
      

      
        <div class="back-to-top">
          <i class="fa fa-arrow-up"></i>
          
            <span id="scrollpercent"><span>0</span>%</span>
          
        </div>
      

    </div>
  </aside>
  


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Yu ZhiPing</span>

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    
      <span class="post-meta-item-text">站点总字数：</span>
    
    <span title="站点总字数">20k</span>
  

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    
      <span class="post-meta-item-text">站点阅读时长 &asymp;</span>
    
    <span title="站点阅读时长">18 分钟</span>
  
</div>









        








        
      </div>
    </footer>

    

    

    

    
  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>














  
    
    
      
    
  
  <script color="0,0,255" opacity="0.5" zindex="-1" count="99" src="//cdn.jsdelivr.net/gh/theme-next/theme-next-canvas-nest@1/canvas-nest.min.js"></script>













  
  <script src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>


  


  <script src="/js/utils.js?v=7.1.0"></script>

  <script src="/js/motion.js?v=7.1.0"></script>



  
  


  <script src="/js/affix.js?v=7.1.0"></script>

  <script src="/js/schemes/pisces.js?v=7.1.0"></script>




  
  <script src="/js/scrollspy.js?v=7.1.0"></script>
<script src="/js/post-details.js?v=7.1.0"></script>



  


  <script src="/js/next-boot.js?v=7.1.0"></script>


  

  

  

  


  
    <script>
  window.livereOptions = {
    refer: '2019/07/18/三维人脸表情合成综述/'
  };
  (function(d, s) {
    var j, e = d.getElementsByTagName(s)[0];
    if (typeof LivereTower === 'function') { return; }
    j = d.createElement(s);
    j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
    j.async = true;
    e.parentNode.insertBefore(j, e);
  })(document, 'script');
</script>

  


  
  <script>
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url).replace(/\/{2,}/g, '/');
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x"></i></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x"></i></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  
  
  <script>
    
    function addCount(Counter) {
      var $visitors = $('.leancloud_visitors');
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();

      Counter('get', '/classes/Counter', { where: JSON.stringify({ url }) })
        .done(function({ results }) {
          if (results.length > 0) {
            var counter = results[0];
            
            Counter('put', '/classes/Counter/' + counter.objectId, JSON.stringify({ time: { '__op': 'Increment', 'amount': 1 } }))
            
              .done(function() {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.time + 1);
              })
            
              .fail(function ({ responseJSON }) {
                console.log('Failed to save Visitor num, with error message: ' + responseJSON.error);
              })
          } else {
            
              Counter('post', '/classes/Counter', JSON.stringify({ title: title, url: url, time: 1 }))
                .done(function() {
                  var $element = $(document.getElementById(url));
                  $element.find('.leancloud-visitors-count').text(1);
                })
                .fail(function() {
                  console.log('Failed to create');
                });
            
          }
        })
        .fail(function ({ responseJSON }) {
          console.log('LeanCloud Counter Error: ' + responseJSON.code + ' ' + responseJSON.error);
        });
    }
    

    $(function() {
      $.get('https://app-router.leancloud.cn/2/route?appId=' + 'p1giGmp2Ifbwu3s9SnfqyIzI-gzGzoHsz')
        .done(function({ api_server }) {
          var Counter = function(method, url, data) {
            return $.ajax({
              method: method,
              url: 'https://' + api_server + '/1.1' + url,
              headers: {
                'X-LC-Id': 'p1giGmp2Ifbwu3s9SnfqyIzI-gzGzoHsz',
                'X-LC-Key': 'jCk503uIW1hzwb3WW47q7U0r',
                'Content-Type': 'application/json',
              },
              data: data
            });
          };
          
            addCount(Counter);
          
        });
    });
  </script>



  

  
  

  
  

  


  

  

  

  

  

  

  

  

  
<script>
  $('.highlight').each(function(i, e) {
    var $wrap = $('<div>').addClass('highlight-wrap');
    $(e).after($wrap);
    $wrap.append($('<button>').addClass('copy-btn').append('复制').on('click', function(e) {
      var code = $(this).parent().find('.code').find('.line').map(function(i, e) {
        return $(e).text();
      }).toArray().join('\n');
      var ta = document.createElement('textarea');
      var yPosition = window.pageYOffset || document.documentElement.scrollTop;
      ta.style.top = yPosition + 'px'; // Prevent page scroll
      ta.style.position = 'absolute';
      ta.style.opacity = '0';
      ta.readOnly = true;
      ta.value = code;
      document.body.appendChild(ta);
      ta.select();
      ta.setSelectionRange(0, code.length);
      ta.readOnly = false;
      var result = document.execCommand('copy');
      
        if (result) $(this).text('复制成功');
        else $(this).text('复制失败');
      
      ta.blur(); // For iOS
      $(this).blur();
    })).on('mouseleave', function(e) {
      var $b = $(this).find('.copy-btn');
      setTimeout(function() {
        $b.text('复制');
      }, 300);
    }).append(e);
  })
</script>


  
	
	<script>
		(function(d, w, c) {
			w.ChatraID = 'Jbk5wXzdk8GfrGHpk';
			var s = d.createElement('script');
			w[c] = w[c] || function() {
				(w[c].q = w[c].q || []).push(arguments);
			};
			s.async = true;
			s.src = 'https://call.chatra.io/chatra.js';
			if (d.head) d.head.appendChild(s);
		})(document, window, 'Chatra');
	</script>


  

</body>
</html>
